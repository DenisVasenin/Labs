{
    "collab_server" : "",
    "contents" : "---\noutput:\n  pdf_document: default\nheader-includes:\n \\usepackage[T2A]{fontenc}\n \\usepackage[utf8]{inputenc}\n \\usepackage[russian]{babel}\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(knitr)\n```\n\n\\centering\\Large \nВыполнение корелляционного и регрессионного анализа для 2-мерной выборки.\n\n\\centering\\large \nПенкин С.В. ИВТ-21\n\n\\centering\\large \nВариант 16\n\n\\raggedright\\large \nЗадание:\n\n\\raggedright\\normalsize\n1) По выборке значений двумерной нормально распределенной СВ найти точечную оценку коэффициента корреляции её компонент. При уровне значимости 0.05 проверить гипотезу о независимости компонент X и Y.\n\n\\raggedright\\normalsize\n2) С помощью МНК получить эмпирическое уравнение линейной регрессии Y на X. Построить график эмпирической прямой с изображением на нем выборочных точек.\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE}\nrows1 = c(8,12,16,20,24,\"n\")\ncols1 = c(5,10,15,20,25,30,\"m\")\nrows = c(8,12,16,20,24)\ncols = c(5,10,15,20,25,30)\ndf = data.frame(c(2,0,0,0,0,2), c(4,3,0,0,0,7), c(0,7,5,7,0,19), c(0,0,30,10,5,45), c(0,0,10,8,6,24), c(0,0,0,0,3,3), c(6,10,45,25,14,100), row.names = rows1)\nnames(df) = cols1\nkable(df, format = \"markdown\")\n```\n\n\\centering\\Large\nВыборочный коэффициент корелляции.\n\n\\raggedright\\large\nНайдем $\\bar{x}, \\bar{y}, \\overline{x y}$:\n\\centering\\large\n\\[ \n\\bar{x} = \\dfrac{1}{n} \\sum_{i=1}^k m_i x_i \\hspace{2em}\n\\bar{y} = \\dfrac{1}{n} \\sum_{j=1}^l n_j y_j \\hspace{2em}\n\\overline{xy} = \\dfrac{1}{n} \\sum_{i=1}^k \\sum_{j=1}^l m_{ij} x_i y_j \n\\]\n\n\\raggedright\\normalsize\n```{r, message=FALSE, warning=FALSE}\n# обьем выборки\nn = 100\n# переменные для вычислений\nx = c() ; xkv = c() ; y = c() ; ykv = c() ; xy = c()\ncount = 1\n# вычисление x, y, xy\nfor (i in 1:length(cols)) {\n    for (k in 1:length(rows)) {\n        x[count] = rows[k] * df[k,i]\n        xkv[count] = rows[k] ^ 2 * df[k,i]\n        y[count] = cols[i] * df[k,i]\n        ykv[count] = cols[i] ^ 2 * df[k,i]\n        xy[count] = rows[k] * cols[i] * df[k,i]\n        count = count + 1\n    }\n}\nx = sum(x) / n ; x\ny = sum(y) / n ; y\nxy = sum(xy) / n ; xy\n```\n\n\\raggedright\\large\nНайдем $\\sigma_x$ и $\\sigma_y$:\n\\centering\\large\n\\[\n\\sigma_x = \\sqrt{\\bar{x^2} - (\\bar{x})^2} \\hspace{2em}\n\\sigma_y = \\sqrt{\\bar{y^2} - (\\bar{y})^2} \\hspace{2em}\n\\bar{x^2} = \\dfrac{1}{n} \\sum_{i=1}^k m_i x_i^2 \\hspace{2em}\n\\bar{y^2} = \\dfrac{1}{n} \\sum_{j=1}^l n_j y_j^2\n\\]\n\n\\raggedright\\normalsize\n```{r}\nxkv = sum(xkv) / n ; xkv\nykv = sum(ykv) / n ; ykv\nvx = sqrt(xkv - x ^ 2) ; vx\nvy = sqrt(ykv - y ^ 2) ; vy\n```\n\n\\raggedright\\large\nНайдем выборочный коэффициент корелляции:\n\\centering\\large\n\\[ \nr = \\dfrac{\\overline{x y} - \\bar{x} * \\bar{y}}{\\sigma_x * \\sigma_y} \n\\]\n\n\\raggedright\\normalsize\n```{r}\nr = (xy - x * y) / (vx * vy) ; r\n```\n\n\\centering\\Large\nПроверка гипотезы о независимости компонент X и Y с помощью статистики Стьюдента.\n\n\\raggedright\\large\n\\[\nH_0 : r = 0\n\\]\n\n\\raggedright\\large\nНайдем наблюдаемое значение критерия:\n\\centering\\large\n\\[ \nT_n = r \\dfrac{\\sqrt{n - 2}}{\\sqrt{1 - r^2}}\n\\]\n\n\\raggedright\\normalsize\n```{r}\n# уровень значимости\na = 0.05\n# число степеней свободы\nk = n - 2\n# критический критерий (по таблице)\nTk = 1.985\n\nTn = r * (sqrt(k) / sqrt(1 - r ^ 2)) ; Tn\n```\n\n\\raggedright\\normalsize\nТак как $T_k < T_n$ , то нулевая гипотеза о равенстве нулю генерального коэффициента корелляции отвергается. Следовательно X и Y кореллированы.\n\n\\centering\\Large\nЭмпирическое уравнение линейной регрессии Y на X.\n\\centering\\large\n\\[\ny = ax + b\n\\]\n\\raggedright\\large\n\\[\nF(a, b) = \\sum_{i=1}^n e^2 = \\sum_{i=1}^n (y_i - (ax_i + b))^2\n\\]\n\n\\raggedright\\large\n\\[\n\\dfrac{dF}{da} = 2 \\sum_{i=1}^n (ax_i^2 + bx_i - x_i y_i) \\hspace{2em}\n\\dfrac{dF}{db} = 2 \\sum_{i=1}^n (ax_i + b - y_i)\n\\]\n\n\\raggedright\\large\n\\[\n\\begin{cases}\n    a \\sum_{i=1}^n x_i^2 + b \\sum_{i=1}^n x_i = \\sum_{i=1}^n x_i y_i \\\\\n    a \\sum_{i=1}^n x_i + bn = \\sum_{i=1}^n y_i\n\\end{cases} \\hspace{2em}\n\\begin{cases}\n    a 6400 + b 80 = 6949.968 \\\\\n    a 80 + b 5 = 86.8746\n\\end{cases} \\hspace{2em}\n\\]\n\n\\centering\\normalsize\nМетодом Крамера получаем: \n\\centering\\large\n\\[\na = 1.08, b = 1.16\n\\]\n\n\\raggedright\\normalsize\n\n```{r}\n# переменные для расчетов\ntmp = c(); y = c()\nm = c(6,10,45,25,14)\n# расчет y для координат графика\nfor (i in 1:length(rows)) {\n    for (k in 1:length(cols)) {\n        tmp[k] = cols[k] * df[i,k]\n    }\n    y[i] = sum(tmp) / m[i] \n}\n```\n```{r, message=FALSE, warning=FALSE}\na = 1.08\nb = 1.16\n\ny1 = a * rows + b\n\nplot(xy.coords(rows, y), xlab = \"x\", ylab = \"y\")\nlines(rows, y1)\n```\n\n",
    "created" : 1482840678602.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2026965753",
    "id" : "4DEAF621",
    "lastKnownWriteTime" : 1486054508,
    "last_content_update" : 1486054508953,
    "path" : "~/Documents/Education/IVT/MMOED/Project_4/Project_4.Rmd",
    "project_path" : "Project_4.Rmd",
    "properties" : {
        "docOutlineVisible" : "0",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}